<!DOCTYPE html><html lang="en" dir="ltr" data-has-toc data-has-sidebar data-theme="dark" class="astro-bguv2lll"> <head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Node Applications | The Gren Programming Language</title><link rel="canonical" href="https://gren-lang.org/book/applications/node/"/><link rel="sitemap" href="/book/sitemap-index.xml"/><link rel="shortcut icon" href="/book/favicon.png" type="image/png"/><meta name="generator" content="Astro v4.6.3"/><meta name="generator" content="Starlight v0.22.1"/><meta property="og:title" content="Node Applications"/><meta property="og:type" content="article"/><meta property="og:url" content="https://gren-lang.org/book/applications/node/"/><meta property="og:locale" content="en"/><meta property="og:description" content="Writing node applications in Gren."/><meta property="og:site_name" content="The Gren Programming Language"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Node Applications"/><meta name="twitter:description" content="Writing node applications in Gren."/><meta name="description" content="Writing node applications in Gren."/><script>
	window.StarlightThemeProvider = (() => {
		const storedTheme =
			typeof localStorage !== 'undefined' && localStorage.getItem('starlight-theme');
		const theme =
			storedTheme ||
			(window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark');
		document.documentElement.dataset.theme = theme === 'light' ? 'light' : 'dark';
		return {
			updatePickers(theme = storedTheme || 'auto') {
				document.querySelectorAll('starlight-theme-select').forEach((picker) => {
					const select = picker.querySelector('select');
					if (select) select.value = theme;
					/** @type {HTMLTemplateElement | null} */
					const tmpl = document.querySelector(`#theme-icons`);
					const newIcon = tmpl && tmpl.content.querySelector('.' + theme);
					if (newIcon) {
						const oldIcon = picker.querySelector('svg.label-icon');
						if (oldIcon) {
							oldIcon.replaceChildren(...newIcon.cloneNode(true).childNodes);
						}
					}
				});
			},
		};
	})();
</script><template id="theme-icons"><svg aria-hidden="true" class="light astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M5 12a1 1 0 0 0-1-1H3a1 1 0 0 0 0 2h1a1 1 0 0 0 1-1Zm.64 5-.71.71a1 1 0 0 0 0 1.41 1 1 0 0 0 1.41 0l.71-.71A1 1 0 0 0 5.64 17ZM12 5a1 1 0 0 0 1-1V3a1 1 0 0 0-2 0v1a1 1 0 0 0 1 1Zm5.66 2.34a1 1 0 0 0 .7-.29l.71-.71a1 1 0 1 0-1.41-1.41l-.66.71a1 1 0 0 0 0 1.41 1 1 0 0 0 .66.29Zm-12-.29a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.71-.71a1.004 1.004 0 1 0-1.43 1.41l.73.71ZM21 11h-1a1 1 0 0 0 0 2h1a1 1 0 0 0 0-2Zm-2.64 6A1 1 0 0 0 17 18.36l.71.71a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.76-.66ZM12 6.5a5.5 5.5 0 1 0 5.5 5.5A5.51 5.51 0 0 0 12 6.5Zm0 9a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7Zm0 3.5a1 1 0 0 0-1 1v1a1 1 0 0 0 2 0v-1a1 1 0 0 0-1-1Z"/></svg> <svg aria-hidden="true" class="dark astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.64 13a1 1 0 0 0-1.05-.14 8.049 8.049 0 0 1-3.37.73 8.15 8.15 0 0 1-8.14-8.1 8.59 8.59 0 0 1 .25-2A1 1 0 0 0 8 2.36a10.14 10.14 0 1 0 14 11.69 1 1 0 0 0-.36-1.05Zm-9.5 6.69A8.14 8.14 0 0 1 7.08 5.22v.27a10.15 10.15 0 0 0 10.14 10.14 9.784 9.784 0 0 0 2.1-.22 8.11 8.11 0 0 1-7.18 4.32v-.04Z"/></svg> <svg aria-hidden="true" class="auto astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg> </template><link rel="stylesheet" href="/book/_astro/index.D0RRpKR3.css">
<style>svg:where(.astro-c6vsoqas){color:var(--sl-icon-color);font-size:var(--sl-icon-size, 1em);width:1em;height:1em}
</style><script type="module" src="/book/_astro/hoisted.zjKXHv8L.js"></script>
<script type="module" src="/book/_astro/page.BO5rBSqo.js"></script><style>.sl-steps{--bullet-size: calc(var(--sl-line-height) * 1rem);--bullet-margin: .375rem;list-style:none;padding-inline-start:0}.sl-steps>li{position:relative;padding-inline-start:calc(var(--bullet-size) + 1rem);padding-bottom:1px;min-height:calc(var(--bullet-size) + var(--bullet-margin))}.sl-steps>li+li{margin-top:0}.sl-steps>li:before{content:counter(list-item);position:absolute;top:0;inset-inline-start:0;width:var(--bullet-size);height:var(--bullet-size);line-height:var(--bullet-size);font-size:var(--sl-text-xs);font-weight:600;text-align:center;color:var(--sl-color-white);background-color:var(--sl-color-gray-6);border-radius:99rem;box-shadow:inset 0 0 0 1px var(--sl-color-gray-5)}.sl-steps>li:not(:last-of-type):after{--guide-width: 1px;content:"";position:absolute;top:calc(var(--bullet-size) + var(--bullet-margin));bottom:var(--bullet-margin);inset-inline-start:calc((var(--bullet-size) - var(--guide-width)) / 2);width:var(--guide-width);background-color:var(--sl-color-hairline-light)}.sl-steps>li>:first-child{--lh: calc(1em * var(--sl-line-height));--shift-y: calc(.5 * (var(--bullet-size) - var(--lh)));transform:translateY(var(--shift-y));margin-bottom:var(--shift-y)}.sl-steps>li>:first-child:where(h1,h2,h3,h4,h5,h6){--lh: calc(1em * var(--sl-line-height-headings))}@supports (--prop: 1lh){.sl-steps>li>:first-child{--lh: 1lh}}
</style><script src="/book/_astro/Tabs.astro_astro_type_script_index_0_lang.Bm-WZ1bf.js" type="module"></script></head> <body class="astro-bguv2lll"> <a href="#_top" class="astro-7q3lir66">Skip to content</a>  <div class="page sl-flex astro-vrdttmbt"> <header class="header astro-vrdttmbt"><div class="header sl-flex astro-kmkmnagf"> <div class="title-wrapper sl-flex astro-kmkmnagf"> <a href="/book/" class="site-title sl-flex astro-m46x6ez3">  <span class="astro-m46x6ez3"> The Gren Programming Language </span> </a>  </div> <div class="sl-flex astro-kmkmnagf"> <site-search data-translations="{&#34;placeholder&#34;:&#34;Search&#34;}" class="astro-v37mnknz"> <button data-open-modal disabled class="astro-v37mnknz">  <svg aria-label="Search" class="astro-v37mnknz astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.71 20.29 18 16.61A9 9 0 1 0 16.61 18l3.68 3.68a.999.999 0 0 0 1.42 0 1 1 0 0 0 0-1.39ZM11 18a7 7 0 1 1 0-14 7 7 0 0 1 0 14Z"/></svg>  <span class="sl-hidden md:sl-block astro-v37mnknz" aria-hidden="true">Search</span> <svg aria-label="(Press / to Search)" class="sl-hidden md:sl-block astro-v37mnknz astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 2H7a5 5 0 0 0-5 5v10a5 5 0 0 0 5 5h10a5 5 0 0 0 5-5V7a5 5 0 0 0-5-5Zm3 15a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V7a3 3 0 0 1 3-3h10a3 3 0 0 1 3 3v10Z"/><path d="M15.293 6.707a1 1 0 1 1 1.414 1.414l-8.485 8.486a1 1 0 0 1-1.414-1.415l8.485-8.485Z"/></svg>  </button> <dialog style="padding:0" aria-label="Search" class="astro-v37mnknz"> <div class="dialog-frame sl-flex astro-v37mnknz">  <button data-close-modal class="sl-flex md:sl-hidden astro-v37mnknz"> Cancel </button> <div class="search-container astro-v37mnknz"> <div id="starlight__search" class="astro-v37mnknz"></div> </div> </div> </dialog> </site-search>    </div> <div class="sl-hidden md:sl-flex right-group astro-kmkmnagf"> <div class="sl-flex social-icons astro-kmkmnagf"> <a href="https://github.com/gren-lang/book" rel="me" class="sl-flex astro-wy4te6ga"><span class="sr-only astro-wy4te6ga">GitHub</span><svg aria-hidden="true" class="astro-wy4te6ga astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg> </a><a href="https://fosstodon.org/@gren_lang" rel="me" class="sl-flex astro-wy4te6ga"><span class="sr-only astro-wy4te6ga">Mastodon</span><svg aria-hidden="true" class="astro-wy4te6ga astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M16.45 17.77c2.77-.33 5.18-2.03 5.49-3.58.47-2.45.44-5.97.44-5.97 0-4.77-3.15-6.17-3.15-6.17-1.58-.72-4.3-1.03-7.13-1.05h-.07c-2.83.02-5.55.33-7.13 1.05 0 0-3.14 1.4-3.14 6.17v.91c-.01.88-.02 1.86 0 2.88.12 4.67.87 9.27 5.2 10.4 2 .53 3.72.64 5.1.57 2.51-.14 3.92-.9 3.92-.9l-.08-1.8s-1.8.56-3.8.5c-2-.08-4.1-.22-4.43-2.66a4.97 4.97 0 0 1-.04-.68s1.96.48 4.44.59c1.51.07 2.94-.09 4.38-.26Zm2.22-3.4h-2.3v-5.6c0-1.19-.5-1.79-1.5-1.79-1.1 0-1.66.71-1.66 2.12v3.07h-2.3V9.1c0-1.4-.55-2.12-1.65-2.12-1 0-1.5.6-1.5 1.78v5.61h-2.3V8.6c0-1.18.3-2.12.9-2.81a3.17 3.17 0 0 1 2.47-1.05c1.18 0 2.07.45 2.66 1.35l.57.96.58-.96a2.97 2.97 0 0 1 2.66-1.35c1.01 0 1.83.36 2.46 1.05.6.7.9 1.63.9 2.81v5.78Z"/></svg> </a><a href="https://discord.gg/Chb9YB9Vmh" rel="me" class="sl-flex astro-wy4te6ga"><span class="sr-only astro-wy4te6ga">Discord</span><svg aria-hidden="true" class="astro-wy4te6ga astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M20.32 4.37a19.8 19.8 0 0 0-4.93-1.51 13.78 13.78 0 0 0-.64 1.28 18.27 18.27 0 0 0-5.5 0 12.64 12.64 0 0 0-.64-1.28h-.05A19.74 19.74 0 0 0 3.64 4.4 20.26 20.26 0 0 0 .11 18.09l.02.02a19.9 19.9 0 0 0 6.04 3.03l.04-.02a14.24 14.24 0 0 0 1.23-2.03.08.08 0 0 0-.05-.07 13.1 13.1 0 0 1-1.9-.92.08.08 0 0 1 .02-.1 10.2 10.2 0 0 0 .41-.31h.04a14.2 14.2 0 0 0 12.1 0l.04.01a9.63 9.63 0 0 0 .4.32.08.08 0 0 1-.03.1 12.29 12.29 0 0 1-1.9.91.08.08 0 0 0-.02.1 15.97 15.97 0 0 0 1.27 2.01h.04a19.84 19.84 0 0 0 6.03-3.05v-.03a20.12 20.12 0 0 0-3.57-13.69ZM8.02 15.33c-1.18 0-2.16-1.08-2.16-2.42 0-1.33.96-2.42 2.16-2.42 1.21 0 2.18 1.1 2.16 2.42 0 1.34-.96 2.42-2.16 2.42Zm7.97 0c-1.18 0-2.15-1.08-2.15-2.42 0-1.33.95-2.42 2.15-2.42 1.22 0 2.18 1.1 2.16 2.42 0 1.34-.94 2.42-2.16 2.42Z"/></svg> </a> </div> <starlight-theme-select>  <label style="--sl-select-width: 6.25em" class="astro-4yphtoen"> <span class="sr-only astro-4yphtoen">Select theme</span> <svg aria-hidden="true" class="icon label-icon astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg>  <select value="auto" class="astro-4yphtoen"> <option value="dark" class="astro-4yphtoen">Dark</option><option value="light" class="astro-4yphtoen">Light</option><option value="auto" selected="true" class="astro-4yphtoen">Auto</option> </select> <svg aria-hidden="true" class="icon caret astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </label>  </starlight-theme-select>  <script>
	StarlightThemeProvider.updatePickers();
</script>   </div> </div> </header> <nav class="sidebar astro-vrdttmbt" aria-label="Main"> <starlight-menu-button class="astro-jif73yzw"> <button aria-expanded="false" aria-label="Menu" aria-controls="starlight__sidebar" class="sl-flex md:sl-hidden astro-jif73yzw"> <svg aria-hidden="true" class="astro-jif73yzw astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M3 8h18a1 1 0 1 0 0-2H3a1 1 0 0 0 0 2Zm18 8H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Zm0-5H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Z"/></svg>  </button> </starlight-menu-button>    <div id="starlight__sidebar" class="sidebar-pane astro-vrdttmbt"> <div class="sidebar-content sl-flex astro-vrdttmbt"> <ul class="top-level astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Introduction</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/book/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Why Gren</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/book/hello_world/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Hello World</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">The Language</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/book/syntax/repl/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Getting started</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/book/syntax/constants/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Constants</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/book/syntax/functions/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Functions</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/book/syntax/numbers/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Numbers</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/book/syntax/arrays/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Arrays</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/book/syntax/strings/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Strings</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/book/syntax/records/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Records</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/book/syntax/types/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Types</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/book/syntax/ifs/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">If expressions</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/book/syntax/lets/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Let expressions</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/book/syntax/custom_types/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Custom types</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/book/syntax/pattern_matching/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Pattern matching</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/book/syntax/destructuring/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Destructuring</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/book/syntax/modules/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Modules</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/book/syntax/comments/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Comments</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Applications</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/book/applications/runtime/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">The Gren Runtime</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/book/applications/tea/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">The Elm Architecture</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/book/applications/browser/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Browser Applications</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/book/applications/node/" aria-current="page" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Node Applications</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/book/applications/commands/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Commands</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/book/applications/tasks/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Tasks</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/book/applications/subscriptions/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Subscriptions</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/book/applications/flags/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Flags</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/book/applications/ports/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Javascript Interop</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/book/applications/nested-tea/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Nested TEA</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Appendix</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/book/appendix/gren_json/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">gren.json</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/book/appendix/faq/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">FAQ</span>  </a> </li> </ul>  </details> </li> </ul>  <div class="md:sl-hidden"> <div class="mobile-preferences sl-flex astro-wu23bvmt"> <div class="sl-flex social-icons astro-wu23bvmt"> <a href="https://github.com/gren-lang/book" rel="me" class="sl-flex astro-wy4te6ga"><span class="sr-only astro-wy4te6ga">GitHub</span><svg aria-hidden="true" class="astro-wy4te6ga astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg> </a><a href="https://fosstodon.org/@gren_lang" rel="me" class="sl-flex astro-wy4te6ga"><span class="sr-only astro-wy4te6ga">Mastodon</span><svg aria-hidden="true" class="astro-wy4te6ga astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M16.45 17.77c2.77-.33 5.18-2.03 5.49-3.58.47-2.45.44-5.97.44-5.97 0-4.77-3.15-6.17-3.15-6.17-1.58-.72-4.3-1.03-7.13-1.05h-.07c-2.83.02-5.55.33-7.13 1.05 0 0-3.14 1.4-3.14 6.17v.91c-.01.88-.02 1.86 0 2.88.12 4.67.87 9.27 5.2 10.4 2 .53 3.72.64 5.1.57 2.51-.14 3.92-.9 3.92-.9l-.08-1.8s-1.8.56-3.8.5c-2-.08-4.1-.22-4.43-2.66a4.97 4.97 0 0 1-.04-.68s1.96.48 4.44.59c1.51.07 2.94-.09 4.38-.26Zm2.22-3.4h-2.3v-5.6c0-1.19-.5-1.79-1.5-1.79-1.1 0-1.66.71-1.66 2.12v3.07h-2.3V9.1c0-1.4-.55-2.12-1.65-2.12-1 0-1.5.6-1.5 1.78v5.61h-2.3V8.6c0-1.18.3-2.12.9-2.81a3.17 3.17 0 0 1 2.47-1.05c1.18 0 2.07.45 2.66 1.35l.57.96.58-.96a2.97 2.97 0 0 1 2.66-1.35c1.01 0 1.83.36 2.46 1.05.6.7.9 1.63.9 2.81v5.78Z"/></svg> </a><a href="https://discord.gg/Chb9YB9Vmh" rel="me" class="sl-flex astro-wy4te6ga"><span class="sr-only astro-wy4te6ga">Discord</span><svg aria-hidden="true" class="astro-wy4te6ga astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M20.32 4.37a19.8 19.8 0 0 0-4.93-1.51 13.78 13.78 0 0 0-.64 1.28 18.27 18.27 0 0 0-5.5 0 12.64 12.64 0 0 0-.64-1.28h-.05A19.74 19.74 0 0 0 3.64 4.4 20.26 20.26 0 0 0 .11 18.09l.02.02a19.9 19.9 0 0 0 6.04 3.03l.04-.02a14.24 14.24 0 0 0 1.23-2.03.08.08 0 0 0-.05-.07 13.1 13.1 0 0 1-1.9-.92.08.08 0 0 1 .02-.1 10.2 10.2 0 0 0 .41-.31h.04a14.2 14.2 0 0 0 12.1 0l.04.01a9.63 9.63 0 0 0 .4.32.08.08 0 0 1-.03.1 12.29 12.29 0 0 1-1.9.91.08.08 0 0 0-.02.1 15.97 15.97 0 0 0 1.27 2.01h.04a19.84 19.84 0 0 0 6.03-3.05v-.03a20.12 20.12 0 0 0-3.57-13.69ZM8.02 15.33c-1.18 0-2.16-1.08-2.16-2.42 0-1.33.96-2.42 2.16-2.42 1.21 0 2.18 1.1 2.16 2.42 0 1.34-.96 2.42-2.16 2.42Zm7.97 0c-1.18 0-2.15-1.08-2.15-2.42 0-1.33.95-2.42 2.15-2.42 1.22 0 2.18 1.1 2.16 2.42 0 1.34-.94 2.42-2.16 2.42Z"/></svg> </a> </div> <starlight-theme-select>  <label style="--sl-select-width: 6.25em" class="astro-4yphtoen"> <span class="sr-only astro-4yphtoen">Select theme</span> <svg aria-hidden="true" class="icon label-icon astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg>  <select value="auto" class="astro-4yphtoen"> <option value="dark" class="astro-4yphtoen">Dark</option><option value="light" class="astro-4yphtoen">Light</option><option value="auto" selected="true" class="astro-4yphtoen">Auto</option> </select> <svg aria-hidden="true" class="icon caret astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </label>  </starlight-theme-select>  <script>
	StarlightThemeProvider.updatePickers();
</script>   </div>  </div> </div> </div> </nav> <div class="main-frame astro-vrdttmbt">  <div class="lg:sl-flex astro-67yu43on"> <aside class="right-sidebar-container astro-67yu43on"> <div class="right-sidebar astro-67yu43on"> <div class="lg:sl-hidden astro-pb3aqygn"><mobile-starlight-toc data-min-h="2" data-max-h="3" class="astro-doynk5tl"><nav aria-labelledby="starlight__on-this-page--mobile" class="astro-doynk5tl"><details id="starlight__mobile-toc" class="astro-doynk5tl"><summary id="starlight__on-this-page--mobile" class="sl-flex astro-doynk5tl"><div class="toggle sl-flex astro-doynk5tl">On this page<svg aria-hidden="true" class="caret astro-doynk5tl astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </div><span class="display-current astro-doynk5tl"></span></summary><div class="dropdown astro-doynk5tl"><ul class="isMobile astro-g2bywc46" style="--depth: 0;"> <li class="astro-g2bywc46" style="--depth: 0;"> <a href="#_top" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Overview</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#simple-program" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Simple Program</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#compile" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Compile</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#module-definition" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Module definition</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#imports" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Imports</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#main-function" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Main function</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#init" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Init</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#lets-make-a-web-server" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Let’s make a web server!</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#main" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Main</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#init-1" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Init</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#update" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Update</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#subscriptions" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Subscriptions</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#more-examples" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">More examples</span> </a>  </li> </ul> </div></details></nav></mobile-starlight-toc></div><div class="right-sidebar-panel sl-hidden lg:sl-block astro-pb3aqygn"><div class="sl-container astro-pb3aqygn"><starlight-toc data-min-h="2" data-max-h="3"><nav aria-labelledby="starlight__on-this-page"><h2 id="starlight__on-this-page">On this page</h2><ul class="astro-g2bywc46" style="--depth: 0;"> <li class="astro-g2bywc46" style="--depth: 0;"> <a href="#_top" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Overview</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#simple-program" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Simple Program</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#compile" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Compile</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#module-definition" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Module definition</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#imports" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Imports</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#main-function" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Main function</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#init" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Init</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#lets-make-a-web-server" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Let’s make a web server!</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#main" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Main</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#init-1" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Init</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#update" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Update</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#subscriptions" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Subscriptions</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#more-examples" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">More examples</span> </a>  </li> </ul> </nav></starlight-toc></div></div> </div> </aside> <div class="main-pane astro-67yu43on">  <main data-pagefind-body lang="en" dir="ltr" class="astro-bguv2lll">    <div class="content-panel astro-7nkwcw3z"> <div class="sl-container astro-7nkwcw3z"> <h1 id="_top" class="astro-j6tvhyss">Node Applications</h1>  </div> </div>  <div class="content-panel astro-7nkwcw3z"> <div class="sl-container astro-7nkwcw3z"> <div class="sl-markdown-content"> <p>Gren has a couple different ways you can write applications that run on nodejs.
We’ll go over each one here, starting with simple programs.</p>
<p>First we need to <a href="/book/hello_world/">init a new project</a>.
But this time, we will target the node platform.
In an empty directory, run:</p>
<div class="expressive-code"><link rel="stylesheet" href="/book/_astro/ec.nhq3f.css"/><script type="module" src="/book/_astro/ec.3zb7u.js"></script><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="sh"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">gren</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">init</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">--platform=node</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="gren init --platform=node"><div></div></button></div></figure></div>
<p>This will create a <code dir="auto">gren.json</code> file configured for node and a <code dir="auto">src</code> directory to hold your source code.</p>
<h2 id="simple-program">Simple Program</h2>
<p><a href="https://packages.gren-lang.org/package/gren-lang/node/version/latest/module/Node#defineSimpleProgram">Node.defineSimpleProgram</a> is good for short-lived programs or scripts.
We’ll go over regular programs in a later section.</p>
<p>Below is an example of the classic Hello World program.
It’s ok if you don’t understand it yet, we will go through it piece by piece in the next sections.</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">src/Main.gren</span></figcaption><pre data-language="elm"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#C792EA;--1:#8D46B4">module</span><span style="--0:#D6DEEB;--1:#403F53"> Main </span><span style="--0:#C792EA;--1:#8D46B4">exposing</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#82AAFF;--1:#3C63B3">main</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> Init</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> Node </span><span style="--0:#C792EA;--1:#8D46B4">exposing</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#C792EA;--1:#8D46B4">Environment</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> Stream</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">6</div></div><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> Task</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">7</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">8</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">9</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">main</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">:</span><span style="--0:#D6DEEB;--1:#403F53"> Node</span><span style="--0:#C792EA;--1:#8D46B4">.SimpleProgram</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">a</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">10</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">main</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">=</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">11</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">Node</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">defineSimpleProgram init</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">12</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">13</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">14</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">init</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Environment</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">-&gt;</span><span style="--0:#D6DEEB;--1:#403F53"> Init</span><span style="--0:#C792EA;--1:#8D46B4">.Task</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#C792EA;--1:#8D46B4">Cmd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">a</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">15</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">init</span><span style="--0:#D6DEEB;--1:#403F53"> env </span><span style="--0:#C792EA;--1:#8D46B4">=</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">16</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">Stream</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">writeLineAsBytes </span><span style="--0:#D9F5DD;--1:#111111">&quot;</span><span style="--0:#ECC48D;--1:#9B504E">Hello, World!</span><span style="--0:#D9F5DD;--1:#111111">&quot;</span><span style="--0:#D6DEEB;--1:#403F53"> env</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">stdout</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">17</div></div><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#097174">|&gt;</span><span style="--0:#D6DEEB;--1:#403F53"> Task</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">onError (</span><span style="--0:#C792EA;--1:#8D46B4">\_</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">-&gt;</span><span style="--0:#D6DEEB;--1:#403F53"> Task</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">succeed env</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">stdout)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">18</div></div><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#097174">|&gt;</span><span style="--0:#D6DEEB;--1:#403F53"> Node</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">endSimpleProgram</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="module Main exposing (main)import Initimport Node exposing (Environment)import Streamimport Taskmain : Node.SimpleProgram amain =    Node.defineSimpleProgram initinit : Environment -> Init.Task (Cmd a)init env =    Stream.writeLineAsBytes &#34;Hello, World!&#34; env.stdout        |> Task.onError (\_ -> Task.succeed env.stdout)        |> Node.endSimpleProgram"><div></div></button></div></figure></div>
<h3 id="compile">Compile</h3>
<p>To run the program you need to compile it.
First, save the above code in <code dir="auto">src/Main.gren</code>.
Then compile and run the resulting js file:</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="sh"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">gren</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">make</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">src/Main.gren</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">node</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">app</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="gren make src/Main.grennode app"><div></div></button></div></figure></div>
<p>You should see:</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="plaintext"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#d6deeb;--1:#403f53">Hello, World!</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="Hello, World!"><div></div></button></div></figure></div>
<p>In the following sections we’ll go over each part of the program to see how it works.</p>
<h3 id="module-definition">Module definition</h3>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">src/Main.gren</span></figcaption><pre data-language="elm"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#C792EA;--1:#8D46B4">module</span><span style="--0:#D6DEEB;--1:#403F53"> Main </span><span style="--0:#C792EA;--1:#8D46B4">exposing</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#82AAFF;--1:#3C63B3">main</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="module Main exposing (main)"><div></div></button></div></figure></div>
<p>This is our <a href="/book/syntax/modules/">module declaration</a> and it is exposing our <code dir="auto">main</code> function which has our program definition.</p>
<h3 id="imports">Imports</h3>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">src/Main.gren</span></figcaption><pre data-language="elm"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> Init</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> Node </span><span style="--0:#C792EA;--1:#8D46B4">exposing</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#C792EA;--1:#8D46B4">Environment</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> Stream</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">6</div></div><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> Task</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="import Initimport Node exposing (Environment)import Streamimport Task"><div></div></button></div></figure></div>
<p>Here we’re <a href="/book/syntax/modules/#imports">importing</a> other modules we will need.
The docs for each of these are helpful if you want to understand more:</p>
<ul>
<li><a href="https://packages.gren-lang.org/package/gren-lang/node/version/latest/module/Init">Init</a></li>
<li><a href="https://packages.gren-lang.org/package/gren-lang/node/version/latest/module/Node">Node</a></li>
<li><a href="https://packages.gren-lang.org/package/gren-lang/core/version/latest/module/Stream">Stream</a></li>
<li><a href="https://packages.gren-lang.org/package/gren-lang/core/version/latest/module/Task">Task</a></li>
</ul>
<h3 id="main-function">Main function</h3>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">src/Main.gren</span></figcaption><pre data-language="elm"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">9</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">main</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">:</span><span style="--0:#D6DEEB;--1:#403F53"> Node</span><span style="--0:#C792EA;--1:#8D46B4">.SimpleProgram</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">a</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">10</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">main</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">=</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">11</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">Node</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">defineSimpleProgram init</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="main : Node.SimpleProgram amain =    Node.defineSimpleProgram init"><div></div></button></div></figure></div>
<p>The <code dir="auto">main</code> function is where Gren expects to find your program definition.
Here we’re defining a <a href="https://packages.gren-lang.org/package/gren-lang/node/version/latest/module/Node#SimpleProgram">SimpleProgram</a>.
All it needs is an init function.</p>
<h3 id="init">Init</h3>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">src/Main.gren</span></figcaption><pre data-language="elm"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">14</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">init</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Environment</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">-&gt;</span><span style="--0:#D6DEEB;--1:#403F53"> Init</span><span style="--0:#C792EA;--1:#8D46B4">.Task</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#C792EA;--1:#8D46B4">Cmd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">a</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">15</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">init</span><span style="--0:#D6DEEB;--1:#403F53"> env </span><span style="--0:#C792EA;--1:#8D46B4">=</span></div></div><div class="ec-line highlight mark tm-label" style="--tmLabel:'1'"><div class="gutter"><div class="ln" aria-hidden="true">16</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">Stream</span><span style="--0:#C792EA;--1:#773b98">.</span><span style="--0:#D6DEEB;--1:#403F53">writeLineAsBytes </span><span style="--0:#D9F5DD;--1:#111111">&quot;</span><span style="--0:#ECC48D;--1:#834442">Hello, World!</span><span style="--0:#D9F5DD;--1:#111111">&quot;</span><span style="--0:#D6DEEB;--1:#403F53"> env</span><span style="--0:#C792EA;--1:#773b98">.</span><span style="--0:#D6DEEB;--1:#403F53">stdout</span></div></div><div class="ec-line highlight mark tm-label" style="--tmLabel:'2'"><div class="gutter"><div class="ln" aria-hidden="true">17</div></div><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#086164">|&gt;</span><span style="--0:#D6DEEB;--1:#403F53"> Task</span><span style="--0:#C792EA;--1:#773b98">.</span><span style="--0:#D6DEEB;--1:#403F53">onError (</span><span style="--0:#C792EA;--1:#773b98">\_</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#086164">-&gt;</span><span style="--0:#D6DEEB;--1:#403F53"> Task</span><span style="--0:#C792EA;--1:#773b98">.</span><span style="--0:#D6DEEB;--1:#403F53">succeed env</span><span style="--0:#C792EA;--1:#773b98">.</span><span style="--0:#D6DEEB;--1:#403F53">stdout)</span></div></div><div class="ec-line highlight mark tm-label" style="--tmLabel:'3'"><div class="gutter"><div class="ln" aria-hidden="true">18</div></div><div class="code"><span class="indent">        </span><span style="--0:#7FDBCA;--1:#086164">|&gt;</span><span style="--0:#D6DEEB;--1:#403F53"> Node</span><span style="--0:#C792EA;--1:#773b98">.</span><span style="--0:#D6DEEB;--1:#403F53">endSimpleProgram</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="init : Environment -> Init.Task (Cmd a)init env =    Stream.writeLineAsBytes &#34;Hello, World!&#34; env.stdout        |> Task.onError (\_ -> Task.succeed env.stdout)        |> Node.endSimpleProgram"><div></div></button></div></figure></div>
<p>Here is the heart of our program.</p>
<ol>
<li>
<p>We start with a string being passed to <a href="https://packages.gren-lang.org/package/gren-lang/core/version/latest/module/Stream#writeLineAsBytes"><code dir="auto">Stream.writeLineAsBytes</code></a>.
It will take a string and write it to a stream as bytes ending in a newline.
We pass it the string we want and the stream we want to write to.
In this case, it’s the <code dir="auto">stdout</code> stream that we get from the node <a href="https://packages.gren-lang.org/package/gren-lang/node/version/latest/module/Node#Environment">environment</a>.
That’s the stream that’s used to display output to the user, or to another program.
But this doesn’t write to <code dir="auto">stdout</code> directly, it gives us a <a href="/book/applications/tasks/">task</a> that describes the effect.</p>
</li>
<li>
<p>Before we can end the program, we need to handle the case where this action fails (maybe the program is being piped to a stream that is closed or doesn’t exist).
So we’re passing the task from the previous function to <a href="https://packages.gren-lang.org/package/gren-lang/core/version/latest/module/Task#onError"><code dir="auto">Task.onError</code></a>.
This will give us a new task.</p>
<p>The first parameter to <code dir="auto">onError</code> is a function that takes the error value and returns the task that we want.
We’re using an <a href="/book/syntax/functions/#anonymous-functions">anonymous function</a> for this.
In our case, we’re ignoring the error and returning a task that will always succeed, using <a href="https://packages.gren-lang.org/package/gren-lang/core/version/latest/module/Task#succeed"><code dir="auto">Task.succeed</code></a>.
The result of this task will be the original stream, so if we hit this error case, nothing will happen.</p>
<p>In a real program, you might want to handle the error by writing to <code dir="auto">stderr</code> and exiting with a <a href="https://packages.gren-lang.org/package/gren-lang/node/version/latest/module/Node#exitWithCode">non-zero status code</a>.</p>
</li>
<li>
<p>Now we can pass our task to <a href="https://packages.gren-lang.org/package/gren-lang/node/version/latest/module/Node#endSimpleProgram"><code dir="auto">Node.endSimpleProgram</code></a>.
This will give us an <a href="https://packages.gren-lang.org/package/gren-lang/node/version/latest/module/Init">init task</a> that will run our task and end the program.</p>
</li>
</ol>
<aside aria-label="Note" class="starlight-aside starlight-aside--note"> <p class="starlight-aside__title" aria-hidden="true"> <svg aria-hidden="true" class="starlight-aside__icon astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 11a1 1 0 0 0-1 1v4a1 1 0 0 0 2 0v-4a1 1 0 0 0-1-1Zm.38-3.92a1 1 0 0 0-.76 0 1 1 0 0 0-.33.21 1.15 1.15 0 0 0-.21.33 1 1 0 0 0 .21 1.09c.097.088.209.16.33.21A1 1 0 0 0 13 8a1.05 1.05 0 0 0-.29-.71 1 1 0 0 0-.33-.21ZM12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Zm0 18a8 8 0 1 1 0-16.001A8 8 0 0 1 12 20Z"/></svg> Note </p> <section class="starlight-aside__content"> <p>Most languages don’t make you handle the potential error condition for simple print statements.
The explicitness here is one of the things that lets Gren give you confidence that your programs are <a href="/book/#correct">correct</a>.
But since this is such a common case with the standard io streams, future versions of gren may have helpers to easily print to those streams specifically.</p> </section> </aside>
<p>This should be enough to get you started making simple programs.
Scroll through the <a href="https://packages.gren-lang.org/">packages and docs</a>.
<a href="https://gren-lang.org/community">Reach out</a> if you need help.
And read on to learn about creating long-lived programs.</p>
<h2 id="lets-make-a-web-server">Let’s make a web server!</h2>
<p>For more complex or long-running programs, we’ll want a full <a href="https://packages.gren-lang.org/package/gren-lang/node/version/latest/module/Node#Program"><code dir="auto">Node.Program</code></a>.
This type of program uses the full <a href="/book/applications/tea/">Elm architecture</a>.</p>
<p>Here’s an example of using <code dir="auto">Node.Program</code> to create an HTTP server.
As usual, we’ll go through it piece by piece in the next sections.</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">src/Main.gren</span></figcaption><pre data-language="elm"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#C792EA;--1:#8D46B4">module</span><span style="--0:#D6DEEB;--1:#403F53"> Main </span><span style="--0:#C792EA;--1:#8D46B4">exposing</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#82AAFF;--1:#3C63B3">main</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">3</div></div><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> HttpServer </span><span style="--0:#C792EA;--1:#8D46B4">exposing</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#C792EA;--1:#8D46B4">Request</span><span style="--0:#D6DEEB;--1:#403F53">, </span><span style="--0:#C792EA;--1:#8D46B4">Server</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">4</div></div><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> HttpServer</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">Response </span><span style="--0:#C792EA;--1:#8D46B4">as</span><span style="--0:#D6DEEB;--1:#403F53"> Response </span><span style="--0:#C792EA;--1:#8D46B4">exposing</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#C792EA;--1:#8D46B4">Response</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">5</div></div><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> Init</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">6</div></div><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> Node </span><span style="--0:#C792EA;--1:#8D46B4">exposing</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#C792EA;--1:#8D46B4">Environment</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">7</div></div><div class="code"><span style="--0:#C792EA;--1:#8D46B4">import</span><span style="--0:#D6DEEB;--1:#403F53"> Task</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">8</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">9</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">10</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">main</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">:</span><span style="--0:#D6DEEB;--1:#403F53"> Node</span><span style="--0:#C792EA;--1:#8D46B4">.Program</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Model</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Msg</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">11</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">main</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">=</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">12</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">Node</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">defineProgram</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">13</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">{ init </span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53"> init</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">14</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">, update </span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53"> update</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">15</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">, subscriptions </span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53"> subscriptions</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">16</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">17</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">18</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">19</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">20</div></div><div class="code"><span style="--0:#C792EA;--1:#8D46B4">type alias Model</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">=</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">21</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">{ server </span><span style="--0:#C792EA;--1:#8D46B4">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Maybe</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Server</span><span style="--0:#D6DEEB;--1:#403F53"> }</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">22</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">23</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">24</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">serverConfig</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">=</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">25</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">{ host </span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">&quot;</span><span style="--0:#ECC48D;--1:#9B504E">localhost</span><span style="--0:#D9F5DD;--1:#111111">&quot;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">26</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">, port_ </span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">3000</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">27</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">28</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">29</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">30</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">init</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Environment</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">-&gt;</span><span style="--0:#D6DEEB;--1:#403F53"> Init</span><span style="--0:#C792EA;--1:#8D46B4">.Task</span><span style="--0:#D6DEEB;--1:#403F53"> { model </span><span style="--0:#C792EA;--1:#8D46B4">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Model</span><span style="--0:#7690A6;--1:#4F687D">,</span><span style="--0:#D6DEEB;--1:#403F53"> command </span><span style="--0:#C792EA;--1:#8D46B4">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Cmd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Msg</span><span style="--0:#D6DEEB;--1:#403F53"> }</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">31</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">init</span><span style="--0:#D6DEEB;--1:#403F53"> env </span><span style="--0:#C792EA;--1:#8D46B4">=</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">32</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">Init</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">await HttpServer</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">initialize </span><span style="--0:#7FDBCA;--1:#097174">&lt;|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">\</span><span style="--0:#D6DEEB;--1:#403F53">serverPermission </span><span style="--0:#7FDBCA;--1:#097174">-&gt;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">33</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">Node</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">startProgram</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">34</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">{ model </span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53"> { server </span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53"> Nothing }</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">35</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">, command </span><span style="--0:#C792EA;--1:#8D46B4">=</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">36</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">HttpServer</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">createServer serverPermission serverConfig</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">37</div></div><div class="code"><span class="indent">                    </span><span style="--0:#7FDBCA;--1:#097174">|&gt;</span><span style="--0:#D6DEEB;--1:#403F53"> Task</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">attempt GotServer</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">38</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">39</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">40</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">41</div></div><div class="code"><span style="--0:#C792EA;--1:#8D46B4">type Msg</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">42</div></div><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53"> GotServer (</span><span style="--0:#C792EA;--1:#8D46B4">Result</span><span style="--0:#D6DEEB;--1:#403F53"> HttpServer</span><span style="--0:#C792EA;--1:#8D46B4">.ServerError</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Server</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">43</div></div><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53"> GotRequest { </span><span style="--0:#C5E478;--1:#3C63B3">request</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#C792EA;--1:#8D46B4">Request</span><span style="--0:#7690A6;--1:#4F687D">,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3C63B3">response</span><span style="--0:#D6DEEB;--1:#403F53">: </span><span style="--0:#C792EA;--1:#8D46B4">Response</span><span style="--0:#D6DEEB;--1:#403F53"> }</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">44</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">45</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">46</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">update</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Msg</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">-&gt;</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Model</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">-&gt;</span><span style="--0:#D6DEEB;--1:#403F53"> { model </span><span style="--0:#C792EA;--1:#8D46B4">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Model</span><span style="--0:#7690A6;--1:#4F687D">,</span><span style="--0:#D6DEEB;--1:#403F53"> command </span><span style="--0:#C792EA;--1:#8D46B4">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Cmd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Msg</span><span style="--0:#D6DEEB;--1:#403F53"> }</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">47</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">update</span><span style="--0:#D6DEEB;--1:#403F53"> msg model </span><span style="--0:#C792EA;--1:#8D46B4">=</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">48</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">when msg is</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">49</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">GotServer result </span><span style="--0:#7FDBCA;--1:#097174">-&gt;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">50</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">when result is</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">51</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">Ok server </span><span style="--0:#7FDBCA;--1:#097174">-&gt;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">52</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                    </span></span><span style="--0:#D6DEEB;--1:#403F53">{ model </span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53"> { server </span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53"> Just server }</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">53</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                    </span></span><span style="--0:#D6DEEB;--1:#403F53">, command </span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53"> Cmd</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">none</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">54</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                    </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">55</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">56</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">Err </span><span style="--0:#C792EA;--1:#8D46B4">_</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">-&gt;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">57</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                    </span></span><span style="--0:#D6DEEB;--1:#403F53">{ model </span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53"> model</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">58</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                    </span></span><span style="--0:#D6DEEB;--1:#403F53">, command </span><span style="--0:#C792EA;--1:#8D46B4">=</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">59</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                        </span></span><span style="--0:#D6DEEB;--1:#403F53">Task</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">execute (Node</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">exitWithCode </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">60</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                    </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">61</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">62</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">GotRequest { request, response } </span><span style="--0:#7FDBCA;--1:#097174">-&gt;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">63</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">{ model </span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53"> model</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">64</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">, command </span><span style="--0:#C792EA;--1:#8D46B4">=</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">65</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">response</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">66</div></div><div class="code"><span class="indent">                    </span><span style="--0:#7FDBCA;--1:#097174">|&gt;</span><span style="--0:#D6DEEB;--1:#403F53"> Response</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">setBody (</span><span style="--0:#D9F5DD;--1:#111111">&quot;</span><span style="--0:#ECC48D;--1:#9B504E">You requested: </span><span style="--0:#D9F5DD;--1:#111111">&quot;</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">++</span><span style="--0:#D6DEEB;--1:#403F53"> request</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">url</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">path)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">67</div></div><div class="code"><span class="indent">                    </span><span style="--0:#7FDBCA;--1:#097174">|&gt;</span><span style="--0:#D6DEEB;--1:#403F53"> Response</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">send</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">68</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">69</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">70</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">71</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">subscriptions</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Model</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">-&gt;</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Sub</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Msg</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">72</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">subscriptions</span><span style="--0:#D6DEEB;--1:#403F53"> model </span><span style="--0:#C792EA;--1:#8D46B4">=</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">73</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">when model</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">server is</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">74</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">Just server </span><span style="--0:#7FDBCA;--1:#097174">-&gt;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">75</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">HttpServer</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">onRequest server</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">76</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#C792EA;--1:#8D46B4">\</span><span style="--0:#D6DEEB;--1:#403F53">req res </span><span style="--0:#7FDBCA;--1:#097174">-&gt;</span><span style="--0:#D6DEEB;--1:#403F53"> GotRequest { request </span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53"> req, response </span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53"> res })</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">77</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">78</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">Nothing </span><span style="--0:#7FDBCA;--1:#097174">-&gt;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">79</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">Sub</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">none</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="module Main exposing (main)import HttpServer exposing (Request, Server)import HttpServer.Response as Response exposing (Response)import Initimport Node exposing (Environment)import Taskmain : Node.Program Model Msgmain =    Node.defineProgram        { init = init        , update = update        , subscriptions = subscriptions        }type alias Model =    { server : Maybe Server }serverConfig =    { host = &#34;localhost&#34;    , port_ = 3000    }init : Environment -> Init.Task { model : Model, command : Cmd Msg }init env =    Init.await HttpServer.initialize <| \serverPermission ->        Node.startProgram            { model = { server = Nothing }            , command =                HttpServer.createServer serverPermission serverConfig                    |> Task.attempt GotServer            }type Msg    = GotServer (Result HttpServer.ServerError Server)    | GotRequest { request: Request, response: Response }update : Msg -> Model -> { model : Model, command : Cmd Msg }update msg model =    when msg is        GotServer result ->            when result is                Ok server ->                    { model = { server = Just server }                    , command = Cmd.none                    }                Err _ ->                    { model = model                    , command =                        Task.execute (Node.exitWithCode 1)                    }        GotRequest { request, response } ->            { model = model            , command =                response                    |> Response.setBody (&#34;You requested: &#34; ++ request.url.path)                    |> Response.send            }subscriptions : Model -> Sub Msgsubscriptions model =    when model.server is        Just server ->            HttpServer.onRequest server                (\req res -> GotRequest { request = req, response = res })        Nothing ->            Sub.none"><div></div></button></div></figure></div>
<p>Save this to <code dir="auto">src/Main.gren</code> and run the program with:</p>
<div class="expressive-code"><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="sh"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">1</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">gren</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">make</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">src/Main.gren</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">2</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">node</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3C63B3">app</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="gren make src/Main.grennode app"><div></div></button></div></figure></div>
<p>You won’t see any output, but if you visit any path on <a href="http://localhost:3000">http://localhost:3000</a> you will see a page showing the URL you visited.
You can quit the program with <code dir="auto">CTRL-c</code>.</p>
<p>Now let’s see what’s happening.</p>
<h3 id="main">Main</h3>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">src/Main.gren</span></figcaption><pre data-language="elm"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">10</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">main</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">:</span><span style="--0:#D6DEEB;--1:#403F53"> Node</span><span style="--0:#C792EA;--1:#8D46B4">.Program</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Model</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Msg</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">11</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">main</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">=</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">12</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">Node</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">defineProgram</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">13</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">{ init </span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53"> init</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">14</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">, update </span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53"> update</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">15</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">, subscriptions </span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53"> subscriptions</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">16</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="main : Node.Program Model Msgmain =    Node.defineProgram        { init = init        , update = update        , subscriptions = subscriptions        }"><div></div></button></div></figure></div>
<p>This time we’re using <a href="https://packages.gren-lang.org/package/gren-lang/node/version/latest/module/Node#defineProgram"><code dir="auto">defineProgram</code></a>.
This defines programs that can trigger effects (like sending HTTP responses) and subscribe to events (like HTTP requests).
We’re defining it using a <a href="/book/syntax/records/">record</a> that points to our <code dir="auto">init</code>, <code dir="auto">update</code>, and <code dir="auto">subscribe</code> functions.
We’ll cover those next.</p>
<h3 id="init-1">Init</h3>
<p>First we define our Model:</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">src/Main.gren</span></figcaption><pre data-language="elm"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">20</div></div><div class="code"><span style="--0:#C792EA;--1:#8D46B4">type alias Model</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">=</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">21</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">{ server </span><span style="--0:#C792EA;--1:#8D46B4">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Maybe</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Server</span><span style="--0:#D6DEEB;--1:#403F53"> }</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="type alias Model =    { server : Maybe Server }"><div></div></button></div></figure></div>
<p>Our model will hold our <a href="https://packages.gren-lang.org/package/gren-lang/node/version/latest/module/HttpServer#Server">Server</a>.
It’s not guaranteed that our server will start (e.g. maybe the port is being used) so we have to hold it in a <a href="https://packages.gren-lang.org/package/gren-lang/core/version/latest/module/Maybe">Maybe</a>.
<code dir="auto">Maybe</code> is core <a href="/book/syntax/custom_types/">custom type</a> with two variants: <code dir="auto">Just something</code> where <code dir="auto">something</code> is the value you want, or <code dir="auto">Nothing</code>.</p>
<p>Next, we define a constant to hold our server configuration:</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">src/Main.gren</span></figcaption><pre data-language="elm"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">24</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">serverConfig</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">=</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">25</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">{ host </span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">&quot;</span><span style="--0:#ECC48D;--1:#9B504E">localhost</span><span style="--0:#D9F5DD;--1:#111111">&quot;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">26</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">, port_ </span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">3000</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">27</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="serverConfig =    { host = &#34;localhost&#34;    , port_ = 3000    }"><div></div></button></div></figure></div>
<p>This will make it easier if we want to change the config, or print it when the server starts.</p>
<p>Next is our <code dir="auto">init</code> function that starts the program:</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">src/Main.gren</span></figcaption><pre data-language="elm"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">30</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">init</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Environment</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">-&gt;</span><span style="--0:#D6DEEB;--1:#403F53"> Init</span><span style="--0:#C792EA;--1:#8D46B4">.Task</span><span style="--0:#D6DEEB;--1:#403F53"> { model </span><span style="--0:#C792EA;--1:#8D46B4">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Model</span><span style="--0:#7690A6;--1:#4F687D">,</span><span style="--0:#D6DEEB;--1:#403F53"> command </span><span style="--0:#C792EA;--1:#8D46B4">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Cmd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Msg</span><span style="--0:#D6DEEB;--1:#403F53"> }</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">31</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">init</span><span style="--0:#D6DEEB;--1:#403F53"> env </span><span style="--0:#C792EA;--1:#8D46B4">=</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">32</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">Init</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">await HttpServer</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">initialize </span><span style="--0:#7FDBCA;--1:#097174">&lt;|</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">\</span><span style="--0:#D6DEEB;--1:#403F53">serverPermission </span><span style="--0:#7FDBCA;--1:#097174">-&gt;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">33</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">Node</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">startProgram</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">34</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">{ model </span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53"> { server </span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53"> Nothing }</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">35</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">, command </span><span style="--0:#C792EA;--1:#8D46B4">=</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">36</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">HttpServer</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">createServer serverPermission serverConfig</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">37</div></div><div class="code"><span class="indent">                    </span><span style="--0:#7FDBCA;--1:#097174">|&gt;</span><span style="--0:#D6DEEB;--1:#403F53"> Task</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">attempt GotServer</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">38</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="init : Environment -> Init.Task { model : Model, command : Cmd Msg }init env =    Init.await HttpServer.initialize <| \serverPermission ->        Node.startProgram            { model = { server = Nothing }            , command =                HttpServer.createServer serverPermission serverConfig                    |> Task.attempt GotServer            }"><div></div></button></div></figure></div>
<p>This is different than the <code dir="auto">init</code> functions we’ve written so far.
It’s wrapped in a call to <a href="https://packages.gren-lang.org/package/gren-lang/node/version/latest/module/Init#await"><code dir="auto">Init.await</code></a>.</p>
<p>Node applications have a concept of subsystems and permissions.
Subsystems are things in the world outside of your program (e.g. the filesystem, network requests, the terminal itself).
Functions that interact with them will require a permission value.
You can only get that value via an init task that initializes the subsystem when you start your program.
This means it’s impossible for library code to trigger effects without you explicitly giving it permission to do so by passing in the permission value.
You can read more about initializing subsystems in the <a href="https://packages.gren-lang.org/package/gren-lang/node/version/latest/module/Init">Init</a> docs.</p>
<p>In our case, we need to initialize the HTTP server subsystem with <a href="https://packages.gren-lang.org/package/gren-lang/node/version/latest/module/HttpServer#initialize"><code dir="auto">HttpServer.initialize</code></a>.
This gives us permission to create the server with <a href="https://packages.gren-lang.org/package/gren-lang/node/version/latest/module/HttpServer#createServer"><code dir="auto">HttpServer.createServer</code></a>.
Because starting a server is something that could fail, <code dir="auto">createServer</code> gives us a <a href="https://packages.gren-lang.org/package/gren-lang/core/version/latest/module/Task">Task</a> that could result in a Server value, or an error.
We use <a href="https://packages.gren-lang.org/package/gren-lang/core/version/latest/module/Task#attempt"><code dir="auto">Task.attempt</code></a> to turn that into a command that we can send to the <a href="/book/applications/runtime/">Gren Runtime</a> to perform the task.</p>
<p>It takes a <code dir="auto">GotServer</code> message that we will receive in our <code dir="auto">update</code> function after the server starts.
We’ll explain that in the next section.</p>
<h3 id="update">Update</h3>
<p>We start by defining our message type:</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">src/Main.gren</span></figcaption><pre data-language="elm"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">41</div></div><div class="code"><span style="--0:#C792EA;--1:#8D46B4">type Msg</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">42</div></div><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53"> GotServer (</span><span style="--0:#C792EA;--1:#8D46B4">Result</span><span style="--0:#D6DEEB;--1:#403F53"> HttpServer</span><span style="--0:#C792EA;--1:#8D46B4">.ServerError</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Server</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">43</div></div><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8D46B4">|</span><span style="--0:#D6DEEB;--1:#403F53"> GotRequest { request </span><span style="--0:#C792EA;--1:#8D46B4">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Request</span><span style="--0:#7690A6;--1:#4F687D">,</span><span style="--0:#D6DEEB;--1:#403F53"> response </span><span style="--0:#C792EA;--1:#8D46B4">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Response</span><span style="--0:#D6DEEB;--1:#403F53"> }</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="type Msg    = GotServer (Result HttpServer.ServerError Server)    | GotRequest { request : Request, response : Response }"><div></div></button></div></figure></div>
<p>This holds all the events that can happen in our system.
In this case there are two: <code dir="auto">GotServer</code> and <code dir="auto">GotRequest</code>.</p>
<p>We’ll receive a <code dir="auto">GotServer</code> message after the server starts because that’s what we specified in <code dir="auto">init</code> earlier.
It will hold a <a href="https://packages.gren-lang.org/package/gren-lang/core/version/latest/module/Result">Result</a>.
A Result is a core <a href="/book/syntax/custom_types/">custom type</a> with two variants:
one with the value we want (in our case, a <a href="https://packages.gren-lang.org/package/gren-lang/node/version/latest/module/HttpServer#Server"><code dir="auto">Server</code></a> value if the server started successfully),
and one with an error value (in our case, a <a href="https://packages.gren-lang.org/package/gren-lang/node/version/latest/module/HttpServer#ServerError"><code dir="auto">ServerError</code></a> if the server failed to start).</p>
<aside aria-label="Note" class="starlight-aside starlight-aside--note"> <p class="starlight-aside__title" aria-hidden="true"> <svg aria-hidden="true" class="starlight-aside__icon astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 11a1 1 0 0 0-1 1v4a1 1 0 0 0 2 0v-4a1 1 0 0 0-1-1Zm.38-3.92a1 1 0 0 0-.76 0 1 1 0 0 0-.33.21 1.15 1.15 0 0 0-.21.33 1 1 0 0 0 .21 1.09c.097.088.209.16.33.21A1 1 0 0 0 13 8a1.05 1.05 0 0 0-.29-.71 1 1 0 0 0-.33-.21ZM12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Zm0 18a8 8 0 1 1 0-16.001A8 8 0 0 1 12 20Z"/></svg> Note </p> <section class="starlight-aside__content"> <p>Notice the parenthesis around the result type.
This lets the compiler know that <code dir="auto">ServerError</code> and <code dir="auto">Server</code> are part of <code dir="auto">Result</code>, not <code dir="auto">GotServer</code>.</p> </section> </aside>
<p>We’ll also receive a <code dir="auto">GotRequest</code> message whenever there is an Http request because it’s what we specified in <code dir="auto">subscriptions</code>, which we’ll cover later.
It will hold a record with a <a href="https://packages.gren-lang.org/package/gren-lang/node/version/latest/module/HttpServer#Request"><code dir="auto">Request</code></a> and a <a href="https://packages.gren-lang.org/package/gren-lang/node/version/latest/module/HttpServer.Response#Response"><code dir="auto">Response</code></a>.
We’ll use those values to send a response back from the server, which we’ll look at soon.</p>
<p>Next we define our update function and <a href="/book/syntax/pattern_matching/">match</a> on that <code dir="auto">Msg</code> type:</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">src/Main.gren</span></figcaption><pre data-language="elm"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">46</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">update</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Msg</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">-&gt;</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Model</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">-&gt;</span><span style="--0:#D6DEEB;--1:#403F53"> { model </span><span style="--0:#C792EA;--1:#8D46B4">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Model</span><span style="--0:#7690A6;--1:#4F687D">,</span><span style="--0:#D6DEEB;--1:#403F53"> command </span><span style="--0:#C792EA;--1:#8D46B4">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Cmd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Msg</span><span style="--0:#D6DEEB;--1:#403F53"> }</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">47</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">update</span><span style="--0:#D6DEEB;--1:#403F53"> msg model </span><span style="--0:#C792EA;--1:#8D46B4">=</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">48</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">when msg is</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="update : Msg -> Model -> { model : Model, command : Cmd Msg }update msg model =    when msg is"><div></div></button></div></figure></div>
<p>First we handle the <code dir="auto">GotServer</code> message:</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">src/Main.gren</span></figcaption><pre data-language="elm"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">49</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">GotServer result </span><span style="--0:#7FDBCA;--1:#097174">-&gt;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">50</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">when result is</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">51</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">Ok server </span><span style="--0:#7FDBCA;--1:#097174">-&gt;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">52</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                    </span></span><span style="--0:#D6DEEB;--1:#403F53">{ model </span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53"> { server </span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53"> Just server }</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">53</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                    </span></span><span style="--0:#D6DEEB;--1:#403F53">, command </span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53"> Cmd</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">none</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">54</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                    </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">55</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">56</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">Err </span><span style="--0:#C792EA;--1:#8D46B4">_</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">-&gt;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">57</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                    </span></span><span style="--0:#D6DEEB;--1:#403F53">{ model </span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53"> model</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">58</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                    </span></span><span style="--0:#D6DEEB;--1:#403F53">, command </span><span style="--0:#C792EA;--1:#8D46B4">=</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">59</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                        </span></span><span style="--0:#D6DEEB;--1:#403F53">Task</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">execute (Node</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">exitWithCode </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">60</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                    </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="        GotServer result ->            when result is                Ok server ->                    { model = { server = Just server }                    , command = Cmd.none                    }                Err _ ->                    { model = model                    , command =                        Task.execute (Node.exitWithCode 1)                    }"><div></div></button></div></figure></div>
<p>Remember when we talked about <a href="https://packages.gren-lang.org/package/gren-lang/core/version/latest/module/Result">Result</a>?</p>
<p>If the server started successfully, we’ll get the <code dir="auto">Ok</code> variant holding the server value, which we’re <a href="/book/syntax/destructuring/">capturing</a> in a <code dir="auto">server</code> variable.
We return a new model that updates the <code dir="auto">server</code> key to <code dir="auto">Just server</code>.
Remember that the <code dir="auto">server</code> key on our model is a <code dir="auto">Maybe</code>, which means it must hold either <code dir="auto">Nothing</code> or <code dir="auto">Just something</code>, which is why we’re setting it to <code dir="auto">Just server</code> instead of <code dir="auto">server</code>.
We’ll see how this is used when we cover the <code dir="auto">subscriptions</code> function later.</p>
<p>If the server failed to start, we’ll get the <code dir="auto">Err</code> variant holding an error value - in our case will be a <a href="https://packages.gren-lang.org/package/gren-lang/node/version/latest/module/HttpServer#ServerError"><code dir="auto">ServerError</code></a>.
We know that because that’s the error type specific in the Task that we get from <a href="https://packages.gren-lang.org/package/gren-lang/node/version/latest/module/HttpServer#createServer"><code dir="auto">createServer</code></a>.</p>
<p>We’re not using the error value so we call it <code dir="auto">_</code>.
And we respond with a command that exits the program with a non-zero status code, which is the appropriate way to end a command line program that did not run successfully.</p>
<p>Next we’re handling HTTP requests in the <code dir="auto">GotRequest</code> case:</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">src/Main.gren</span></figcaption><pre data-language="elm"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">62</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">GotRequest { request, response } </span><span style="--0:#7FDBCA;--1:#097174">-&gt;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">63</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">{ model </span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53"> model</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">64</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">, command </span><span style="--0:#C792EA;--1:#8D46B4">=</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">65</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">response</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">66</div></div><div class="code"><span class="indent">                    </span><span style="--0:#7FDBCA;--1:#097174">|&gt;</span><span style="--0:#D6DEEB;--1:#403F53"> Response</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">setBody (</span><span style="--0:#D9F5DD;--1:#111111">&quot;</span><span style="--0:#ECC48D;--1:#9B504E">You requested: </span><span style="--0:#D9F5DD;--1:#111111">&quot;</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">++</span><span style="--0:#D6DEEB;--1:#403F53"> request</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">url</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">path)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">67</div></div><div class="code"><span class="indent">                    </span><span style="--0:#7FDBCA;--1:#097174">|&gt;</span><span style="--0:#D6DEEB;--1:#403F53"> Response</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">send</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">68</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="        GotRequest { request, response } ->            { model = model            , command =                response                    |> Response.setBody (&#34;You requested: &#34; ++ request.url.path)                    |> Response.send            }"><div></div></button></div></figure></div>
<p>We get a <code dir="auto">GotRequest</code> message whenever someone makes an HTTP request to the server (because we <a href="#subscriptions">subscribed</a> to that event - desribed later).
We’re <a href="/book/syntax/destructuring/">destructuring</a> it to get the request and response values that are attached to the message.</p>
<p>The <a href="https://packages.gren-lang.org/package/gren-lang/node/version/latest/module/HttpServer#Request">request</a> is a record with all the information about our request.
We’re using it to display the path with <a href="https://packages.gren-lang.org/package/gren-lang/node/version/latest/module/HttpServer.Response#setBody"><code dir="auto">Response.setBody</code></a>.
But in a real server you may want to use it to route different paths to different functions that handle the logic and response for that request.</p>
<p>The <a href="https://packages.gren-lang.org/package/gren-lang/node/version/latest/module/HttpServer.Response#Response">response</a> is a value that represents our HTTP response.
It is created in the Gren runtime and required to call functions that change the response (like <code dir="auto">Response.setBody</code>).
We turn the response into a command for the runtime to actually send the HTTP response with <a href="https://packages.gren-lang.org/package/gren-lang/node/version/latest/module/HttpServer.Response#send"><code dir="auto">Response.send</code></a>.</p>
<h3 id="subscriptions">Subscriptions</h3>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">src/Main.gren</span></figcaption><pre data-language="elm"><code><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">71</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">subscriptions</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Model</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">-&gt;</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Sub</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">Msg</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">72</div></div><div class="code"><span style="--0:#82AAFF;--1:#3C63B3">subscriptions</span><span style="--0:#D6DEEB;--1:#403F53"> model </span><span style="--0:#C792EA;--1:#8D46B4">=</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">73</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">when model</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">server is</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">74</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">Just server </span><span style="--0:#7FDBCA;--1:#097174">-&gt;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">75</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">HttpServer</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">onRequest server</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">76</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">                </span></span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#C792EA;--1:#8D46B4">\</span><span style="--0:#D6DEEB;--1:#403F53">req res </span><span style="--0:#7FDBCA;--1:#097174">-&gt;</span><span style="--0:#D6DEEB;--1:#403F53"> GotRequest { request </span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53"> req, response </span><span style="--0:#C792EA;--1:#8D46B4">=</span><span style="--0:#D6DEEB;--1:#403F53"> res })</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">77</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">78</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">Nothing </span><span style="--0:#7FDBCA;--1:#097174">-&gt;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln" aria-hidden="true">79</div></div><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">Sub</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#D6DEEB;--1:#403F53">none</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="subscriptions : Model -> Sub Msgsubscriptions model =    when model.server is        Just server ->            HttpServer.onRequest server                (\req res -> GotRequest { request = req, response = res })        Nothing ->            Sub.none"><div></div></button></div></figure></div>
<p><a href="/book/applications/subscriptions/">Subscriptions</a> are how we connect to external events.
When we return a subscription, we’re telling the <a href="/book/applications/runtime/">Gren runtime</a> what messages to send to our <code dir="auto">update</code> function for the events we care about.</p>
<p>Earlier in the book, we’ve been returning <a href="https://packages.gren-lang.org/package/gren-lang/core/version/latest/module/Platform.Sub#none"><code dir="auto">Sub.none</code></a> since we haven’t had any subscriptions.
But now, if we successfully started the server, we want to receive a <code dir="auto">GotRequest</code> message whenever there is an HTTP request.
We do that by calling <a href="https://packages.gren-lang.org/package/gren-lang/node/version/latest/module/HttpServer#onRequest"><code dir="auto">HttpServer.onRequest</code></a>,
which takes the server value we saved to our model (see the <code dir="auto">GotServer</code> branch of our <code dir="auto">update</code> function) and a function that returns a message.
In our case, we’re using an <a href="/book/syntax/functions/#function-pipelines">anonymous function</a> that returns our <code dir="auto">GotRequest</code> message.</p>
<h2 id="more-examples">More examples</h2>
<p>For more examples of node applications, see:</p>
<ul>
<li><a href="https://github.com/gren-lang/example-projects/blob/main/cat/src/Main.gren">The <code dir="auto">cat</code> example project</a></li>
<li><a href="https://github.com/gren-lang/example-projects/blob/main/http-server/src/Main.gren">The HTTP server example project</a></li>
<li><a href="https://github.com/gren-lang/integration-tests/blob/main/http-client/src/Main.gren">The HTTP client integration test</a></li>
</ul> </div> <footer class="astro-3yyafb3n"> <div class="meta sl-flex astro-3yyafb3n">   </div> <div class="pagination-links astro-u2l5gyhi" dir="ltr"> <a href="/book/applications/browser/" rel="prev" class="astro-u2l5gyhi"> <svg aria-hidden="true" class="astro-u2l5gyhi astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.5rem;"><path d="M17 11H9.41l3.3-3.29a1.004 1.004 0 1 0-1.42-1.42l-5 5a1 1 0 0 0-.21.33 1 1 0 0 0 0 .76 1 1 0 0 0 .21.33l5 5a1.002 1.002 0 0 0 1.639-.325 1 1 0 0 0-.219-1.095L9.41 13H17a1 1 0 0 0 0-2Z"/></svg>  <span class="astro-u2l5gyhi"> Previous <br class="astro-u2l5gyhi"> <span class="link-title astro-u2l5gyhi">Browser Applications</span> </span> </a> <a href="/book/applications/commands/" rel="next" class="astro-u2l5gyhi"> <svg aria-hidden="true" class="astro-u2l5gyhi astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.5rem;"><path d="M17.92 11.62a1.001 1.001 0 0 0-.21-.33l-5-5a1.003 1.003 0 1 0-1.42 1.42l3.3 3.29H7a1 1 0 0 0 0 2h7.59l-3.3 3.29a1.002 1.002 0 0 0 .325 1.639 1 1 0 0 0 1.095-.219l5-5a1 1 0 0 0 .21-.33 1 1 0 0 0 0-.76Z"/></svg>  <span class="astro-u2l5gyhi"> Next <br class="astro-u2l5gyhi"> <span class="link-title astro-u2l5gyhi">Commands</span> </span> </a> </div>  </footer>  </div> </div>   </main> </div> </div>  </div> </div>  </body></html>